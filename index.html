<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena Pro - Gestão ERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg: #0f172a; --card: #1e293b; --accent: #38b6ff;
            --success: #10b981; --danger: #ef4444; --text: #f8fafc;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }

        /* LOGIN OVERLAY */
        #login-screen {
            position: fixed; inset: 0; background: var(--bg); z-index: 2000;
            display: flex; align-items: center; justify-content: center;
        }
        .login-box { background: var(--card); padding: 40px; border-radius: 20px; width: 350px; text-align: center; }

        /* NAVBAR */
        nav { background: var(--card); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #334155; }
        .nav-links button { background: none; border: none; color: white; margin-left: 15px; cursor: pointer; font-weight: bold; }
        .nav-links button:hover { color: var(--accent); }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        /* SEÇÕES */
        .page { display: none; animation: fadeIn 0.3s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* DASHBOARD & TABLES */
        .main-grid { display: grid; grid-template-columns: 1fr 350px; gap: 20px; }
        .section-card { background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #334155; }
        
        input, select { background: #0f172a; border: 1px solid #475569; color: white; padding: 10px; border-radius: 8px; width: 100%; margin-bottom: 10px; }
        
        .btn { padding: 10px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-primary { background: var(--accent); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }

        /* QUADRAS */
        .courts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; }
        .court-btn { aspect-ratio: 1/1; border-radius: 12px; border: none; color: white; cursor: pointer; font-weight: bold; }
        .free { background: #334155; } .busy { background: var(--danger); } .preparing { background: #f59e0b; }

        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: var(--card); padding: 30px; border-radius: 20px; width: 90%; max-width: 500px; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <h2 style="margin-bottom:20px">ARENA PRO LOGIN</h2>
            <input type="text" id="user-input" placeholder="Usuário (admin ou func)">
            <input type="password" id="pass-input" placeholder="Senha">
            <button class="btn btn-primary" style="width:100%" onclick="login()">ENTRAR</button>
            <p id="login-err" style="color:var(--danger); margin-top:10px; font-size:0.8rem"></p>
        </div>
    </div>

    <nav>
        <div class="logo"><h1>ARENA<span style="color:var(--accent)">PRO</span></h1></div>
        <div class="nav-links">
            <button onclick="showPage('pdv')"><i class="fas fa-shopping-cart"></i> PDV</button>
            <button id="nav-config" onclick="showPage('config')"><i class="fas fa-cog"></i> Configurações</button>
            <button onclick="logout()" style="color:var(--danger)">Sair</button>
        </div>
    </nav>

    <div class="container">
        
        <div id="pdv" class="page active">
            <div class="main-grid">
                <div class="section-card">
                    <h2>Monitor de Quadras</h2><br>
                    <div class="courts-grid" id="courts-grid"></div>
                </div>
                <div class="section-card">
                    <h2>Comandas Abertas</h2>
                    <div id="orders-list"></div>
                </div>
            </div>
        </div>

        <div id="config" class="page">
            <div class="section-card">
                <h2>Cadastro de Produtos</h2>
                <div style="display:flex; gap:10px; margin-top:15px">
                    <input type="text" id="prod-name" placeholder="Nome do Produto">
                    <input type="number" id="prod-price" placeholder="Preço R$">
                    <button class="btn btn-success" onclick="addProd()">Adicionar</button>
                </div>
                <table id="table-prods">
                    <thead><tr><th>Nome</th><th>Preço</th><th>Ação</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div class="section-card">
                <h2>Cadastro de Clientes (Mensalistas)</h2>
                <div style="display:flex; gap:10px; margin-top:15px">
                    <input type="text" id="cli-name" placeholder="Nome do Cliente">
                    <button class="btn btn-success" onclick="addCli()">Cadastrar</button>
                </div>
                <table id="table-clis">
                    <thead><tr><th>Nome</th><th>Ação</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <h2 id="modal-title">Quadra 1</h2><br>
            <select id="select-cli"><option value="">Cliente Avulso</option></select>
            <div id="menu-area" style="display:grid; grid-template-columns:1fr 1fr; gap:5px; margin:15px 0"></div>
            <div id="cart-area" style="border-top:1px solid #334155; padding-top:10px"></div>
            <h3 id="total-val" style="margin:15px 0">Total: R$ 0,00</h3>
            <button class="btn btn-success" style="width:100%" onclick="finishOrder()">LANÇAR PEDIDO</button>
            <button class="btn btn-danger" style="width:100%; margin-top:5px" onclick="closeModal()">CANCELAR</button>
        </div>
    </div>

<script>
    // DADOS INICIAIS
    let db = JSON.parse(localStorage.getItem('arena_erp_db')) || {
        products: [{id:1, name:'Água', price:6}],
        clients: [],
        orders: [],
        role: null
    };

    let currentCart = [];
    let selectedCourt = null;

    // LOGIN
    function login() {
        const user = document.getElementById('user-input').value;
        const pass = document.getElementById('pass-input').value;
        
        if(user === 'admin' && pass === '123') db.role = 'admin';
        else if(user === 'func' && pass === '123') db.role = 'func';
        else return document.getElementById('login-err').textContent = "Acesso negado!";

        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('nav-config').style.display = db.role === 'admin' ? 'inline' : 'none';
        save();
        render();
    }

    function logout() {
        db.role = null;
        save();
        location.reload();
    }

    function save() {
        localStorage.setItem('arena_erp_db', JSON.stringify(db));
        render();
    }

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    // CADASTROS
    function addProd() {
        const name = document.getElementById('prod-name').value;
        const price = parseFloat(document.getElementById('prod-price').value);
        if(name && price) {
            db.products.push({id: Date.now(), name, price});
            save();
        }
    }

    function addCli() {
        const name = document.getElementById('cli-name').value;
        if(name) {
            db.clients.push({id: Date.now(), name});
            save();
        }
    }

    function delItem(type, id) {
        db[type] = db[type].filter(x => x.id !== id);
        save();
    }

    // PDV LÓGICA
    function openModal(court) {
        selectedCourt = court;
        currentCart = [];
        document.getElementById('modal-title').textContent = `Quadra ${court}`;
        
        // Carregar Clientes no Select
        const sel = document.getElementById('select-cli');
        sel.innerHTML = '<option value="">Cliente Avulso</option>';
        db.clients.forEach(c => sel.innerHTML += `<option value="${c.name}">${c.name}</option>`);

        // Carregar Menu
        const menu = document.getElementById('menu-area');
        menu.innerHTML = '';
        db.products.forEach(p => {
            const btn = document.createElement('button');
            btn.className = 'btn btn-primary';
            btn.style.fontSize = '0.7rem';
            btn.textContent = `${p.name} (R$${p.price})`;
            btn.onclick = () => {
                currentCart.push(p);
                renderCart();
            };
            menu.appendChild(btn);
        });

        renderCart();
        document.getElementById('modal').style.display = 'flex';
    }

    function renderCart() {
        const area = document.getElementById('cart-area');
        area.innerHTML = '';
        let total = 0;
        currentCart.forEach(i => {
            total += i.price;
            area.innerHTML += `<div style="font-size:0.8rem">1x ${i.name} - R$ ${i.price}</div>`;
        });
        document.getElementById('total-val').textContent = `Total: R$ ${total.toFixed(2)}`;
    }

    function finishOrder() {
        if(!currentCart.length) return;
        db.orders.push({
            id: Date.now(),
            court: selectedCourt,
            client: document.getElementById('select-cli').value || 'Avulso',
            items: [...currentCart],
            total: currentCart.reduce((a,b) => a + b.price, 0),
            status: 'busy'
        });
        save();
        closeModal();
    }

    function changeStatus(id) {
        const o = db.orders.find(x => x.id === id);
        if(o.status === 'busy') o.status = 'preparing';
        else o.status = 'done';
        save();
    }

    function render() {
        // Render Quadras
        const grid = document.getElementById('courts-grid');
        grid.innerHTML = '';
        for(let i=1; i<=12; i++){
            const active = db.orders.find(o => o.court === i && o.status !== 'done');
            grid.innerHTML += `<button class="court-btn ${active?active.status:'free'}" onclick="openModal(${i})">${i}</button>`;
        }

        // Render Pedidos
        const list = document.getElementById('orders-list');
        list.innerHTML = '';
        db.orders.filter(o => o.status !== 'done').forEach(o => {
            list.innerHTML += `
                <div class="section-card" style="border-left:4px solid var(--accent)">
                    <strong>Q${o.court} - ${o.client}</strong><br>
                    <small>${o.items.map(i=>i.name).join(', ')}</small><br>
                    <strong>R$ ${o.total.toFixed(2)}</strong>
                    <button class="btn btn-primary" style="padding:5px; font-size:0.7rem" onclick="changeStatus(${o.id})">Avançar</button>
                </div>`;
        });

        // Render Tabelas Config
        const tbodyProd = document.querySelector('#table-prods tbody');
        tbodyProd.innerHTML = '';
        db.products.forEach(p => {
            tbodyProd.innerHTML += `<tr><td>${p.name}</td><td>R$ ${p.price}</td><td><button class="btn btn-danger" onclick="delItem('products',${p.id})">X</button></td></tr>`;
        });

        const tbodyCli = document.querySelector('#table-clis tbody');
        tbodyCli.innerHTML = '';
        db.clients.forEach(c => {
            tbodyCli.innerHTML += `<tr><td>${c.name}</td><td><button class="btn btn-danger" onclick="delItem('clients',${c.id})">X</button></td></tr>`;
        });
    }

    function closeModal() { document.getElementById('modal').style.display = 'none'; }
    
    // Auto-login se já estiver logado
    if(db.role) {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('nav-config').style.display = db.role === 'admin' ? 'inline' : 'none';
    }
    render();
</script>
</body>
</html>
